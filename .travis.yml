language: node_js
node_js:
- '10'
- '12'
- 'node'
os: linux
cache:
  directories:
  - node_modules
env:
  global:
  - secure: Bg08bmtZxlt18xVd7IT3Ft8rC8Cd3iT2txSqoFKaUERu2FzlaPvi+DS5K0SeOqAB9LfyRST/Msdg+jmPEvQ/0VXa2lfhqf31YSrXStnd9h1Owxr53KPV3O6FX1mfH8RlmHVDosKUR6mJeiush4MSEFPCmB1VBTwpyRcbBt3sbJ0=
  - secure: M4PJdQwYF0dWq+/bMhz4WTRhiKnDuuvgwLImzGQQ0I5zEz6yQofUVmXsAdYkqTvhr8klO+XQktzq62wsWADIe1eb5Vlym87rZweA1MmhzhpfSgYSwQ9IdpVXRbqFVB7HbqrGTHqOSfGOu27e8z4RNg8h3EXCiTnN1qHyY0N5vrI=
script: xvfb-run npm test -- --browsers ChromeHeadlessWithoutAutoplayPolicy --single-run
deploy:
  provider: npm
  email: irfs@bbc.co.uk
  api_token:
    secure: "QRQt729opZcpIORHT1yxYjUH42ClzCTJYZJkAeEHFBkOVsEntStDw+cqsCeLZoc26qlkKJKOheMfM30ZMpMTIZTweQyFpEYNmmxp1uJEsHA8NacZC66+1jq4fVXBQ/lB2HT8Sq4kz1fxnYXiiSXR13aC5VEoeHtj8g2N8CytqOo="
  on:
    tags: true
    repo: bbc/peaks.js
    node_js: 'node'
